# NoSQL 훑어보기

## 등장 배경

- 모바일, SNS 등의 발전으로 데이터량의 폭발적 증가
  - 특히 비정형 데이터(로그 등)의 양과 중요성 증가
- RDB의 한계
  - Scale Out 한계
    - 자동 샤딩을 대부분 지원하지 않음
  - 정형화 된 스키마
    - 비정형 데이터 처리에 부적합
  - 고비용
    - 대량 로그 처리를 위해 값비싼 Oracle RAC를 쓸 것인가
  - 대규모 비정형 데이터
    - 수백 테라, 페타바이트의 데이터를 RDB에서 SQL로 정렬, 집계는 사실상 불가능

## 특징

RDB의 한계의 대칭

- 분산 DB를 바탕 개념으로 깔고 Scale Out 지원
- 스키마 불필요
- 오픈소스

## 바탕 이론

### BASE

> Basically Available, Soft state, Eventual Consistency

- 기본적 가용성: 부분적 장애가 발생할 수는 있어도 시스템 전체가 중단되지는 않음
- 소프트한 상태: 데이터 사본의 엄격한 일관성을 요구하지 않으며 노드의 상태는 내부 데이터가 아닌 외부로부터의 데이터(ex: replication)에 의해 결정
- 결과적 일관성: 일관성이 맞지 않을 수 있으나 약간의 지연 시간 후에는 일관성이 맞게 됨

>RDB에서 보장하는 ACID와 상반되는 개념

### CAP

> 분산 시스템에서 Consistency, Availability, Partition Tolerance 중 3가지 모두를 달성할 수는 없다.

- A: 분산 시스템의 특정 노드에 장애가 발생하더라도 클라이언트는 분산 시스템에 데이터를 RW 할 수 있다.
  - 특정 요청이 장애로 인해 분산 시스템 전체에서 처리되지 못한다면 A 훼손
- P: 노드 사이에 전송되는 메시지가 네트워크에서 손실될 수 있다.
  - 즉, P를 배제하려면 메시지가 손실될 수 없는 네트워크를 구성해야 하는데, 이는 현실적으로 불가능

>결국 CAP 중에서 P는 무조건 선택되어야 하고, C와 A 중에서 하나만을 선택할 수 있다.

>참고: http://eincs.com/2013/07/misleading-and-truth-of-cap-theorem/

### PACELC

![](https://i.stack.imgur.com/lV2pB.png)

> Partition 발생(네트워크 장애)하면 Availability와 Consistency 중 하나만 선택 가능하고,
>- 네트워크 장애 시 데이터를 모든 노드에 전파할 수는 없으므로 접근 가능한 노드에만 데이터를 써서 A를 취하고 C를 포기하거나,
>- 또는 모든 노드에 전파되지 않으면 일부 노드에 전파된 데이터를 롤백 시켜서 C를 취하고 A를 포기해야 한다.
>
> Else이면(네트워크 장애 아니면) Latency와 Consistency 중 하나만 선택 가능하다.
>- 모든 노드에 쓰려면 지연 시간이 발생하므로 C는 취할 수 있지만 L은 포기해야 하고,
>
>- 반대로 일부 노드에만 써서 L을 취하고 C를 포기할 수도 있다.


